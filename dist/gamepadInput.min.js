var rAF=window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.requestAnimationFrame,gamepadInput={haveEvents:"GamepadEvent"in window,haveWebkitEvents:"WebKitGamepadEvent"in window,gamepadInitialized:!1,gamepadButtonState:[],gamepadAxesState:[],buttonEventListener:function(e){var a="button_"+e;window.addEventListener(a,function(e){gamepadInput.buttonCallbackFunction(e)})},buttonEventDisaptcher:function(e,a){var t="button_"+e,n=new CustomEvent(t,{detail:{name:t,value:a}});window.dispatchEvent(n)},axesEventListener:function(e){var a="axes_"+e;window.addEventListener(a,function(e){gamepadInput.axesCallbackFunction(e)})},axesEventDisaptcher:function(e,a){var t="axes_"+e,n=new CustomEvent(t,{detail:{name:t,value:a}});window.dispatchEvent(n)},axisPassesThreshold:function(e){return Math.abs(e)>.1},monitorLoop:function(){let e=window.navigator.getGamepads();(e=Array.prototype.slice.call(e)).forEach((e,a)=>{if(e)if(1==gamepadInput.gamepadInitialized){for(i=0;i<e.buttons.length;i++)e.buttons[i].value!=gamepadInput.gamepadButtonState[i]&&(gamepadInput.buttonEventDisaptcher(i,e.buttons[i].value),gamepadInput.gamepadButtonState[i]=e.buttons[i].value);for(i=0;i<e.axes.length;i++)e.axes[i]!=gamepadInput.gamepadAxesState[i]&&(gamepadInput.axisPassesThreshold(e.axes[i])?(gamepadInput.axesEventDisaptcher(i,e.axes[i]),gamepadInput.gamepadAxesState[i]=e.axes[i]):0!=gamepadInput.gamepadAxesState[i]&&(gamepadInput.axesEventDisaptcher(i,0),gamepadInput.gamepadAxesState[i]=0))}else{for(i=0;i<e.buttons.length;i++)gamepadInput.gamepadButtonState.push(e.buttons[i].value),gamepadInput.buttonEventListener(i);for(i=0;i<e.axes.length;i++)gamepadInput.gamepadAxesState.push(e.axes[i]),gamepadInput.axesEventListener(i);gamepadInput.gamepadInitialized=!0}}),rAF(gamepadInput.monitorLoop)},initialize:function(){gamepadInput.haveEvents?(window.addEventListener("gamepadconnected",gamepadInput.monitorLoop),window.addEventListener("gamepaddisconnected",gamepadInput.monitorLoop)):gamepadInput.haveWebkitEvents&&(window.addEventListener("webkitgamepadconnected",gamepadInput.monitorLoop),window.addEventListener("webkitgamepaddisconnected",gamepadInput.monitorLoop))}};